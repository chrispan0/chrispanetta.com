(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[5024],{

/***/ 376699:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(813110);self._fe4d99ebe0d2d259646a80d250150d47 = self._fe4d99ebe0d2d259646a80d250150d47 || {};(function(__c) {var xc=__c.xc;var Mc=__c.Mc;var P=__c.P;var ly=__c.ly;var Xg=__c.Xg;var C=__c.C;var mg=__c.mg;var D=__c.D;var O=__c.O;var Et=__c.Et;
var O5=function(){const [a]=(0,__c.dc)(()=>Et());return a},QCb=function(a){switch(a){case 4:return O("9ND0kg");case 2:return O("ibdecg");case 7:return O("446quA");case 5:return O("j1fbqg");case 1:return O("O5i4AQ");case 6:return O("C0VHsg");case 3:return O("+IXmVg");default:throw new D(a);}},RCb=function(a){return b=>({type:"react",node:(0,__c.N)(a,{...b})})},SCb=function(a){return b=>({type:"dom",render:c=>a(b,c)})},UCb=function(a){var b,c=a.Iw,d=a.content;a=a.context;__c.A("formula"===(null===d||
void 0===d?void 0:null===(b=d.ag)||void 0===b?void 0:b.type));b=d.ag.value;switch(b.type){case "invalid":b=b.A7;break;case "canonical":b=b.uH;break;default:throw new D(b);}__c.A(b.startsWith("="));const e=d.rI;b={type:"dom",render:h=>h.innerText=""};let f;switch(e.type){case 7:f=b;break;case 1:case 3:case 4:case 2:case 5:case 6:f=TCb(c,a,d.Ax);break;case 0:f={type:"react",node:P5(__c.HT,{label:QCb(e.error),children:P5(__c.YN,{width:"full",display:"flex",justifyContent:"center",children:P5(__c.Zgb,
{tone:"critical"})})})};break;default:throw new D(e);}if(!f)return b;c=mg(__c.SR,a.attrs);d=__c.oI(a.attrs.textAlign,"formula",void 0,()=>e.type);const g={textAlign:__c.Rta(d,c.direction),justifyContent:__c.Sta(d)};switch(f.type){case "dom":return{type:"dom",render:h=>{Object.assign(h.style,g);f.render(h)}};case "react":return{type:"react",node:P5("div",{style:g,children:f.node})};default:throw new D(f);}},TCb=function(a,b,c){var d;return null===(d=a.Iaa)||void 0===d?void 0:d.call(a,{context:b,value:c})},
YCb=function(a){const b=a.Iw,c=a.De;a=a.y8a;b.Iaa=VCb;b.Gra=d=>UCb({...d,Iw:b});b.Hra=RCb(WCb({De:c,HL:void 0}));b.Jra=XCb(a);b.Kra=RCb(Q5)},ZCb=function(a,b,c){const d=[a];for(;null!=a&&a!==b;)(a=c.next(a))&&d.push(a);return d},$Cb=function({label:a,width:b,height:c,scale:d,highlight:e,selected:f}){return P5("div",{style:{width:b,height:c,transform:`scale(${d})`},className:"bx74uQ",children:P5(__c.rv,{className:R5({yiml1g:e,oYlhXA:f}),size:"small",alignment:"center",children:a})})},bDb=function({fd:a,
highlight:b,scale:c,xv:d,Ym:e,MLa:f}){const g=S5(()=>{const m=null===d||void 0===d?void 0:d.get();if(null!=m&&0!==m.length)return new __c.JE(m)},[d]),h=e(1),k=e(c),l={ssE9Tg:!a,OkifGQ:a};return P5(__c.sv,{po:"light",light:"light",Oq:"light",dark:"light",children:m=>P5("div",{className:R5("ze9QCQ",l,m.className),style:{width:k,height:k},children:P5("div",{style:{width:h,height:h,transform:`scale(${c})`},className:R5("N7J3UA",l),ref:null===g||void 0===g?void 0:g.Yf,children:P5(__c.ZN,{className:R5("m8CFdg",
l,{G6wL4w:f,W_E0wA:b}),ariaLabel:O("ruWN9A"),children:P5(aDb,{size:"tiny"})})})})})},dDb=function(){const a=new cDb,b=new __c.QU,c=T5(f=>{const {scale:g=1,size:h="small",MLa:k=!0}=f,l=U5(m=>a.Ym(m,h),[h]);return P5(bDb,{...f,scale:g,fd:"rtl"===f.sheet.direction,highlight:null!=f.selection&&a.c_a(f.sheet,f.selection),Ym:l,MLa:k})}),d=T5(f=>{const {scale:g=1,size:h="small"}=f,k=U5(n=>a.Ym(n,h),[h]),l=U5(n=>null!=f.selection&&a.hHa(f.selection).has(n),[f.selection]),m=U5(n=>null!=f.selection&&a.kYa(f.sheet,
f.selection).has(n),[f.sheet,f.selection]);return P5(V5,{...f,scale:g,Ym:k,iAa:l,aIa:m,bC:b})}),e=T5(f=>{const {scale:g=1,size:h="small"}=f,k=U5(n=>a.Ym(n,h),[h]),l=U5(n=>null!=f.selection&&a.jHa(f.selection).has(n),[f.selection]),m=U5(n=>null!=f.selection&&a.lYa(f.sheet,f.selection).has(n),[f.sheet,f.selection]);return P5(W5,{...f,scale:g,Ym:k,bIa:m,EAa:l,bC:b})});return{lMa:c,kMa:d,mMa:e}},eDb=function(a){const b=a.Cq,c=()=>null;return __c.du(d=>P5(X5,{...d,Cq:b,Yj:c}))},gDb=function({sheet:a,scaleFactor:b,
range:c,Gd:d,Wza:e}){fDb(()=>Y5(()=>{if(null!=d.current&&null!=e.current){var f,g=null!==(f=null===b||void 0===b?void 0:b.get())&&void 0!==f?f:1;f="rtl"===a.direction;f=c?a.qa(c.Vb)*g*(f?1:-1):0;var h=c?-a.ua(c.Yb)*g:0;d.current.style.transform=`translate(${f}px, ${h}px)`;e.current.style.width=`${a.width*g}px`;e.current.style.height=`${a.height*g}px`}}),[a,c,d,e,b])},jDb=function({onScroll:a}){const b=new hDb(a);return{$F:b,saa:T5(c=>P5(iDb,{sheet:c.sheet,$F:b,children:c.children}))}},lDb=function(a){const b=
a.Cq,c=a.Vd,d=a.SHa,e=({children:k})=>k,{$F:f,saa:g}=jDb({onScroll:a.onScroll});class h extends kDb{get bH(){const k=this.props.Gb.iE;switch(k){case "screen":return g;case "print":return e;default:throw new D(k);}}componentDidMount(){d.HHa(this.props.item,{Wb:this.props.Wb,Gb:this.props.Gb,Hg:this.props.Hg})}componentWillUnmount(){d.kRa(this.props.item,{Wb:this.props.Wb,Gb:this.props.Gb,Hg:this.props.Hg})}render(){d.HHa(this.props.item,{Wb:this.props.Wb,Gb:this.props.Gb,Hg:this.props.Hg});return P5(Z5,
{...this.props,scaleFactor:this.scaleFactor,Cq:b,Vd:c,bH:this.bH,SHa:d})}constructor(...k){super(...k);this.scaleFactor=$5(()=>{const l=this.props.item;var m=this.props.Gb,n=m.iE;m=m.zoom;switch(n){case "screen":return 1;case "print":n=d.DXa(l);if(!n)return 1;({width:n}=new __c.Uy(l,n.Wb,{zoom:m}));return n/l.config.width;default:throw new D(n);}})}}return{bOa:h,$F:f}},mDb=function(a,b){if(null!=b&&null!=b.Vb&&null!=b.Yb&&null!=b.ed&&null!=b.vd){var c=a.qa(b.Vb),d=a.ua(b.Yb),e=a.qa(b.ed)+b.ed.width-
c;a=a.ua(b.vd)+b.vd.height-d;return __c.ns({top:d,left:c,width:e,height:a})}},oDb=function(a){const b=a.Cq,c=()=>null;return d=>P5(nDb,{...d,Cq:b,Yj:c})},pDb=function(a,b,c){return a<c&&c<b},qDb=function(a,b){return a.na===b.na&&a.column===b.column&&a.edge===b.edge},rDb=function(a,b){return a.column===b.column&&a.na===b.na&&a.Ida===b.Ida&&a.textAlign===b.textAlign},vDb=function(a,b,c,d,e){if(0===d.length||0===e.length)return[];const f=sDb(b,c,d,e),g=tDb(b,c,d,e),h=uDb(a,b,c,d,e),k=a.zXa(b),l=a.$Wa(b),
m="rtl"===b.direction;a=f.map(n=>{var p,q,r=n.M7a,t=n.sfa,u=n.GGa;const w=n.color,x=n.weight;n=n.Tb;const y=m?-1:1,z=null===(p=h.get(a6(r,u)))||void 0===p?void 0:p.Ha;p=null===(q=h.get(a6(t,u)))||void 0===q?void 0:q.qa;if(null!=z&&null!=p){q=C(k.get(u.na));var B=C(l.get(r.column));r=C(l.get(t.column));u="start"===u.boundary?q.start:q.end;q=B.start;t="start"===t.boundary?r.start:r.end;return{color:w,weight:x,Tb:n,p1:new __c.Or(q+z*y,u),p2:new __c.Or(t+p*y,u),...__c.ny((t-q)*y,n*x,z)}}}).filter(__c.ub);
return[...g.map(n=>{var p,q,r=n.uua,t=n.T7a,u=n.vfa;const w=n.color,x=n.weight;n=n.Tb;const y=null===(p=h.get(a6(r,t)))||void 0===p?void 0:p.Ca;p=null===(q=h.get(a6(r,u)))||void 0===q?void 0:q.ua;if(null!=y&&null!=p){q=C(l.get(r.column));var z=C(k.get(t.na));t=C(k.get(u.na));r="start"===r.boundary?q.start:q.end;q=z.start;u="start"===u.boundary?t.start:t.end;return{color:w,weight:x,Tb:n,p1:new __c.Or(r,q+y),p2:new __c.Or(r,u+p),...__c.ny(u-q,n*x,y)}}}).filter(__c.ub),...a]},wDb=function(a){const b=
[];a=a.filter(c=>0!==c.weight&&null!=c.color);a=__c.qd(a,c=>c.weight);a=Array.from(a.entries()).sort(([c],[d])=>c-d);for(const [c,d]of a){a=__c.qd(d,e=>`${e.Ri}_${e.Si}`);for(const [,e]of a){const {Si:f,Ri:g}=e[0];a=__c.qd(e,h=>h.color);for(const [h,k]of a)b.push({weight:c,color:h,lines:k,Ri:g,Si:f})}}return b},yDb=function(a,b,c,d){var e=xDb;const f=b.flatMap(k=>a.layout.rows.last()===k?[{na:k,boundary:"start"},{na:k,boundary:"end"}]:[{na:k,boundary:"start"}]),g=c.flatMap(k=>a.layout.cols.last()===
k?[{column:k,boundary:"start"},{column:k,boundary:"end"}]:[{column:k,boundary:"start"}]),h=new Map;for(const k of b)for(const l of c)b=l&&k?e.RHa.$5a(a,l,k,d):void 0,b&&h.set(`${l.id}:${k.id}`,b);c=vDb(e,a,h,f,g);return wDb(c)},sDb=function(a,b,c,d){const e=[];for(const k of c)for(const l of d){c=k.na;var f=l.column,g=a.layout.cells.get(c,f);if(!g||g.span.Yb===c)if(c=b.get(`${f.id}:${c.id}`),c="start"===k.boundary?null===c||void 0===c?void 0:c.ua:null===c||void 0===c?void 0:c.Ca){g=e[e.length-1];
f=(f=a.layout.cols.next(f))?{column:f,boundary:"start"}:{column:C(a.layout.cols.last()),boundary:"end"};var h;if(h=g)h=g.sfa,h=h.column===l.column&&h.boundary===l.boundary;h&&(h=g.GGa,h=h.na===k.na&&h.boundary===k.boundary);h&&g.color===c.color&&g.weight===c.weight&&g.Tb===c.Tb&&0===g.Tb?g.sfa=f:e.push({GGa:k,M7a:l,sfa:f,color:c.color,weight:c.weight,Tb:c.Tb})}}return e},tDb=function(a,b,c,d){const e=[];for(const k of d)for(const l of c){var f=l.na;d=k.column;var g=a.layout.cells.get(f,d);if(!g||
g.span.Vb===d)if(d=b.get(`${d.id}:${f.id}`),d="start"===k.boundary?null===d||void 0===d?void 0:d.qa:null===d||void 0===d?void 0:d.Ha){g=e[e.length-1];f=(f=a.layout.rows.next(f))?{na:f,boundary:"start"}:{na:C(a.layout.rows.last()),boundary:"end"};var h;if(h=g)h=g.uua,h=h.column===k.column&&h.boundary===k.boundary;h&&(h=g.vfa,h=h.na===l.na&&h.boundary===l.boundary);h&&g.color===d.color&&g.weight===d.weight&&g.Tb===d.Tb&&0===g.Tb?g.vfa=f:e.push({uua:k,T7a:l,vfa:f,color:d.color,weight:d.weight,Tb:d.Tb})}}return e},
uDb=function(a,b,c,d,e){const f=a.RHa.nSa(c,b.layout.rows.last(),b.layout.cols.last());a=(q,r)=>{const t=f.get(q)||0,u=f.get(r)||0;return t<=u?q:r};const g=new Map;if(0===d.length||0===e.length)return g;var h=[],k=b.layout.cols.kc(e[0].column);k&&h.push({column:k,boundary:"start"});h.push(...e);(e=b.layout.cols.next(e[e.length-1].column))&&h.push({column:e,boundary:"start"});e=[];(k=b.layout.rows.kc(d[0].na))&&e.push({na:k,boundary:"start"});e.push(...d);(d=b.layout.rows.next(d[d.length-1].na))&&
e.push({na:d,boundary:"start"});for(const q of h){h=(d="start"===q.boundary?q.column:void 0)?b.layout.cols.kc(d):b.layout.cols.last();for(const r of e){var l="start"===r.boundary?r.na:void 0;k=l?b.layout.rows.kc(l):b.layout.rows.last();var m=d&&l&&c.get(`${d.id}:${l.id}`),n=d&&k&&c.get(`${d.id}:${k.id}`);l=h&&l&&c.get(`${h.id}:${l.id}`);var p=h&&k&&c.get(`${h.id}:${k.id}`);k="end"===q.boundary?null===l||void 0===l?void 0:l.Ha:null===m||void 0===m?void 0:m.qa;m="end"===r.boundary?null===n||void 0===
n?void 0:n.Ca:null===m||void 0===m?void 0:m.ua;n="end"===q.boundary?null===p||void 0===p?void 0:p.Ha:null===n||void 0===n?void 0:n.qa;l="end"===r.boundary?null===p||void 0===p?void 0:p.Ca:null===l||void 0===l?void 0:l.ua;p=__c.ky({ua:n,Ca:k,qa:l,Ha:m},a);let t;switch(p){case "blockStart":t=n;break;case "blockEnd":t=k;break;case "inlineStart":t=l;break;case "inlineEnd":t=m;break;default:t=void 0}const {height:u,width:w}=1===(null===t||void 0===t?void 0:t.Tb)?{height:t.weight,width:t.weight}:{height:Math.max((null===
l||void 0===l?void 0:l.weight)||0,(null===m||void 0===m?void 0:m.weight)||0),width:Math.max((null===n||void 0===n?void 0:n.weight)||0,(null===k||void 0===k?void 0:k.weight)||0)};g.set(a6(q,r),__c.hy(p,u/2,w/2))}}return g},b6=function(a,b,c,d,e){if(a&&b){if(b.hidden||a.hidden)a=void 0;else{var f=b.Ar?a.Ar?void 0:a:b;a=__c.jy(b.borderStyle,a.borderStyle,d,c,e,null===f||void 0===f?void 0:f.borderStyle)}return a}return null!==(f=null===a||void 0===a?void 0:a.borderStyle)&&void 0!==f?f:null===b||void 0===
b?void 0:b.borderStyle},zDb=function(a,b,c,d){var e;const f=b&&c&&a.layout.cells.get(c,b);var g,h,k=b&&c?a.layout.attrs.get(Xg({$_:void 0,i0:void 0,e0:void 0}),null!==(g=null===f||void 0===f?void 0:f.span.Yb)&&void 0!==g?g:c,null!==(h=null===f||void 0===f?void 0:f.span.Vb)&&void 0!==h?h:b)||{}:void 0;if(b&&c){var l,m;d=(null===d||void 0===d?void 0:null===(e=d.get(c6(null!==(l=null===f||void 0===f?void 0:f.span.Vb)&&void 0!==l?l:b,null!==(m=null===f||void 0===f?void 0:f.span.Yb)&&void 0!==m?m:c)))||
void 0===e?void 0:e.ua)||!1;b={color:a.ci.color,weight:a.ci.weight,Tb:ly(a.ci.Bd)};if(!k)return a.Uk?void 0:{borderStyle:b,Ar:!0,hidden:d};c=d6(k.$_);e=e6(k.i0);k=f6(k.e0);return null==c&&null==e&&null==k?a.Uk?void 0:{borderStyle:b,Ar:!0,hidden:d}:{borderStyle:{color:null!==c&&void 0!==c?c:b.color,weight:null!==e&&void 0!==e?e:b.weight,Tb:k?ly(k):b.Tb},Ar:!1,hidden:d}}},ADb=function(a,b,c,d){var e;const f=b&&c&&a.layout.cells.get(c,b);var g,h,k=b&&c?a.layout.attrs.get(Xg({Z_:void 0,h0:void 0,c0:void 0}),
null!==(g=null===f||void 0===f?void 0:f.span.Yb)&&void 0!==g?g:c,null!==(h=null===f||void 0===f?void 0:f.span.Vb)&&void 0!==h?h:b)||{}:void 0;if(b&&c){var l,m;d=(null===d||void 0===d?void 0:null===(e=d.get(c6(null!==(l=null===f||void 0===f?void 0:f.span.Vb)&&void 0!==l?l:b,null!==(m=null===f||void 0===f?void 0:f.span.Yb)&&void 0!==m?m:c)))||void 0===e?void 0:e.Ca)||!1;b={color:a.ci.color,weight:a.ci.weight,Tb:ly(a.ci.Bd)};if(!k)return a.Uk?void 0:{borderStyle:b,Ar:!0,hidden:d};c=d6(k.Z_);e=e6(k.h0);
k=f6(k.c0);return null==c&&null==e&&null==k?a.Uk?void 0:{borderStyle:b,Ar:!0,hidden:d}:{borderStyle:{color:null!==c&&void 0!==c?c:b.color,weight:null!==e&&void 0!==e?e:b.weight,Tb:k?ly(k):b.Tb},Ar:!1,hidden:d}}},BDb=function(a,b,c,d){var e;const f=b&&c&&a.layout.cells.get(c,b);var g,h,k=b&&c?a.layout.attrs.get(Xg({b0:void 0,k0:void 0,g0:void 0}),null!==(g=null===f||void 0===f?void 0:f.span.Yb)&&void 0!==g?g:c,null!==(h=null===f||void 0===f?void 0:f.span.Vb)&&void 0!==h?h:b)||{}:void 0;if(b&&c){var l,
m;d=(null===d||void 0===d?void 0:null===(e=d.get(c6(null!==(l=null===f||void 0===f?void 0:f.span.Vb)&&void 0!==l?l:b,null!==(m=null===f||void 0===f?void 0:f.span.Yb)&&void 0!==m?m:c)))||void 0===e?void 0:e.qa)||!1;b={color:a.ci.color,weight:a.ci.weight,Tb:ly(a.ci.Bd)};if(!k)return a.Uk?void 0:{borderStyle:b,Ar:!0,hidden:d};c=d6(k.b0);e=e6(k.k0);k=f6(k.g0);return null==c&&null==e&&null==k?a.Uk?void 0:{borderStyle:b,Ar:!0,hidden:d}:{borderStyle:{color:null!==c&&void 0!==c?c:b.color,weight:null!==e&&
void 0!==e?e:b.weight,Tb:k?ly(k):b.Tb},Ar:!1,hidden:d}}},CDb=function(a,b,c,d){var e;const f=b&&c&&a.layout.cells.get(c,b);var g,h,k=b&&c?a.layout.attrs.get(Xg({a0:void 0,j0:void 0,f0:void 0}),null!==(g=null===f||void 0===f?void 0:f.span.Yb)&&void 0!==g?g:c,null!==(h=null===f||void 0===f?void 0:f.span.Vb)&&void 0!==h?h:b)||{}:void 0;if(b&&c){var l,m;d=(null===d||void 0===d?void 0:null===(e=d.get(c6(null!==(l=null===f||void 0===f?void 0:f.span.Vb)&&void 0!==l?l:b,null!==(m=null===f||void 0===f?void 0:
f.span.Yb)&&void 0!==m?m:c)))||void 0===e?void 0:e.Ha)||!1;b={color:a.ci.color,weight:a.ci.weight,Tb:ly(a.ci.Bd)};if(!k)return a.Uk?void 0:{borderStyle:b,Ar:!0,hidden:d};c=d6(k.a0);e=e6(k.j0);k=f6(k.f0);return null==c&&null==e&&null==k?a.Uk?void 0:{borderStyle:b,Ar:!0,hidden:d}:{borderStyle:{color:null!==c&&void 0!==c?c:b.color,weight:null!==e&&void 0!==e?e:b.weight,Tb:k?ly(k):b.Tb},Ar:!1,hidden:d}}},d6=function(a){return null==a||"inherit"===a?void 0:a},e6=function(a){return null==a||"inherit"===
a?void 0:Number(a.split("px")[0])},f6=function(a){return null==a||"inherit"===a?void 0:a.split(" ").map(b=>{b=Number(b);return 0<b?b:void 0}).filter(__c.ub)},g6=function(a,b,c){let d=0;for(;null!=a&&a!==b;)(a=c.next(a))&&d++;return d},DDb=function(a,b){return(null===a||void 0===a?void 0:a.Ca)===(null===b||void 0===b?void 0:b.Ca)&&(null===a||void 0===a?void 0:a.ua)===(null===b||void 0===b?void 0:b.ua)&&(null===a||void 0===a?void 0:a.Ha)===(null===b||void 0===b?void 0:b.Ha)&&(null===a||void 0===a?void 0:
a.qa)===(null===b||void 0===b?void 0:b.qa)},FDb=function(a){const b={transform:"translate(-1000px, -1000px) scale(0)"},c={Uta:b,RD:b,Ba:{},Hx:{}},d=h6(()=>({style:a.CY.style||c,qV:a.qV}),({style:f,qV:g})=>{var h;Object.assign(a.Tca.style,f.Uta);Object.assign(a.AM.style,f.RD);Object.assign(a.SD.style,f.Ba);Object.assign(a.KA.style,f.Hx);({textDecoration:f}=(null===(h=a.CY.style)||void 0===h?void 0:h.Ba)||{});a.SD.classList.toggle("OQx3PQ","underline"===f);a.SD.classList.toggle("_99ezUA","line-through"===
f);a.SD.classList.toggle("kppAqQ","underline line-through"===f);a.SD.style.display=g?"none":"unset"},{fireImmediately:!0,equals:i6.structural}),e=h6(()=>a.qV?void 0:a.renderer,f=>{a.t1&&"react"!==(null===f||void 0===f?void 0:f.type)?(a.t1=void 0,a.dX.remove()):a.KA.innerHTML="";switch(null===f||void 0===f?void 0:f.type){case "react":a.t1=EDb(f.node,a.dX);a.KA.appendChild(a.dX);break;case "dom":f.render(a.KA);break;case void 0:break;default:throw new D(f);}a.sW()},{fireImmediately:!0});return()=>{d();
e()}},HDb=function(a){const b=a.Jw,c=a.XG,d=new GDb(a.aY);return e=>P5(j6,{...e,XG:c,Jw:b,Oha:d})},WCb=({De:a,HL:b})=>c=>(0,__c.N)(__c.sab,{...c,De:a,HL:b}),k6=__webpack_require__(443763),l6=k6.Fragment,P5=k6.jsx,m6=k6.jsxs;var T5=__webpack_require__(736241).Pi;var n6=__webpack_require__(875604),o6=n6.Component,IDb=n6.createRef,kDb=n6.PureComponent,U5=n6.useCallback,fDb=n6.useEffect,S5=n6.useMemo,JDb=n6.useState;var p6=__webpack_require__(42782),q6=p6.aD,Y5=p6.EH,i6=p6.p6,$5=p6.Fl,r6=p6.LO,h6=p6.U5;var s6=__webpack_require__(240236).gn;var KDb=__webpack_require__,LDb=KDb(993864),R5=KDb.n_x(LDb)();var MDb=__webpack_require__(358579).Z;var t6=__webpack_require__(649799),u6=t6.Om,v6=t6.kq,w6=t6.YN;var EDb=__webpack_require__(204358).createPortal;var NDb=T5(a=>{var b,c,d="rtl"===a.sheet.direction;d={H2wykw:!d,UweldA:d};const [e]=JDb(()=>Et()),f={get:U5(()=>{var g;const h=null===e||void 0===e?void 0:null===(g=e.current)||void 0===g?void 0:g.getBoundingClientRect();var k,l;g={top:0,left:0,width:null!==(k=null===h||void 0===h?void 0:h.width)&&void 0!==k?k:0,height:null!==(l=null===h||void 0===h?void 0:h.height)&&void 0!==l?l:0};return __c.ns(g)},[e])};return m6("div",{className:R5("nMvVqA",d),children:[m6("div",{ref:MDb(a.Gd,e),className:"_0YOFPg",
children:[P5(a.Cq,{...a,viewport:f}),P5("div",{className:R5("Gdl7fQ",d),children:null===(c=a.mra)||void 0===c?void 0:null===(b=c.get())||void 0===b?void 0:b.map((g,h)=>P5(g,{},h))})]}),"visible"===a.Zlb&&m6(l6,{children:[P5("div",{className:R5("_32sKQw",d),children:P5(a.ZNa,{...a})}),P5("div",{className:R5("xdIsTQ",d),children:P5(a.cOa,{...a})}),P5("div",{className:R5("rsTRSA",d),children:P5(a.aOa,{...a})})]})]})}),ODb=T5(a=>{a=a.content;__c.v("text2"===a.type||"text3"===a.type);switch(a.type){case "text2":return P5(l6,
{children:a.value.Y});case "text3":return P5(l6,{children:__c.mq.ya(a.value).cells.Y()});default:throw new D(a);}});var VCb=SCb((a,b)=>{const c=a.value;({Oi:a}=mg(__c.Wg,a.context.attrs));const d=document.createElement("div");"wrap"===a&&(d.className="dt4Dlg",d.style.overflowWrap="break-word");d.innerText=c;b.appendChild(d)});var XCb=a=>SCb((b,c)=>{const d=b.content;b=b.context;if(d.value.isEmpty)for(;c.lastChild;)c.lastChild.remove();else({Oi:b}=mg(__c.Wg,b.attrs)),"wrap"===b&&(c=c.appendChild(document.createElement("div")),c.className="dt4Dlg"),a.render({container:c,text:d.value,Fa:void 0,writingMode:1,bd:"start",Ff:PDb(d,b)})}),PDb=u6((a,b)=>{if("wrap"===b)return[];a=a.value.Y.split("\n").map(c=>c.length+1);a.pop();return a},{equals:i6.structural});var Q5=class a extends o6{static j(b){P(b,{Oi:$5})}get Oi(){return mg(__c.Wg,this.props.context.attrs).Oi}render(){var b=this.props.content;const c=this.props.context;if(b.value.isEmpty)return null;b=P5(this.props.Yj,{content:b,na:c.na,col:c.col,Oi:this.Oi},this.key++);return"wrap"===this.Oi?P5("div",{className:"dt4Dlg",children:b}):P5(l6,{children:b})}constructor(...b){super(...b);a.j(this);this.key=0}};Q5=s6([Mc],Q5);var QDb=4*__c.gv,RDb=3*__c.gv;var cDb=class{Ym(a,b){return"large"===b?QDb*a:RDb*a}constructor(){this.c_a=u6((a,b)=>{var c,d;b=b.get();return null!=b&&a.layout.rows.count()===((null===(c=b.rows)||void 0===c?void 0:c.size)||0)&&a.layout.cols.count()===((null===(d=b.columns)||void 0===d?void 0:d.size)||0)});this.hHa=v6(a=>{var b;return new Set((null===(b=a.get())||void 0===b?void 0:b.columns)||[])},{equals:__c.Ph});this.jHa=v6(a=>{var b;return new Set((null===(b=a.get())||void 0===b?void 0:b.rows)||[])},{equals:__c.Ph});this.kYa=
u6((a,b)=>{var {cells:c}=b.get()||{};if(!c||0===c.size)return new Set;b=this.hHa(b);const d=new Set;for(const e of c){c=a.layout.cells.get(e.na,e.column);for(const f of ZCb(c?c.span.Vb:e.column,c?c.span.ed:e.column,a.layout.cols))(0===b.size||b.has(f))&&d.add(f)}return d},{equals:__c.Ph});this.lYa=u6((a,b)=>{var {cells:c}=b.get()||{};if(!c||0===c.size)return new Set;b=this.jHa(b);const d=new Set;for(const e of c){c=a.layout.cells.get(e.na,e.column);for(const f of ZCb(c?c.span.Yb:e.na,c?c.span.vd:
e.na,a.layout.rows))(0===b.size||b.has(f))&&d.add(f)}return d},{equals:__c.Ph})}};var V5=class a extends o6{static j(b){P(b,{fd:$5,Go:$5,koa:$5})}get fd(){return"rtl"===this.props.sheet.direction}get Go(){var b;const c=null===(b=this.props.xv)||void 0===b?void 0:b.get();if(null!=c&&0!==c.length)return new __c.JE(c)}get koa(){var b,c,d;return null===(c=(d=this.props).jXa)||void 0===c?void 0:null===(b=c.call(d))||void 0===b?void 0:b.get()}render(){return P5(__c.sv,{po:"light",light:"light",Oq:"light",dark:"light",children:this.ARa})}constructor(...b){super(...b);a.j(this);this.onMouseMove=
q6(c=>{const {onMouseMove:d,sheet:e,scale:f=1}=this.props;null===d||void 0===d?void 0:d(c,e,"column",f)});this.onMouseLeave=q6(c=>{var d,e;null===(d=(e=this.props).onMouseLeave)||void 0===d?void 0:d.call(e,c)});this.D5a=()=>{const {sheet:c,aIa:d,iAa:e,Ym:f,scale:g=1}=this.props;let h=-1;return P5("div",{style:void 0,className:R5("Vt2_4w",{jNbTIg:!this.fd,gtA7Dw:this.fd},{Tn3nUw:void 0}),onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,children:c.cols.map(k=>{h++;return P5(SDb,{col:k,label:__c.Ox(h),
Lna:d,Er:e,Ym:f,scale:g},k.id)})})};this.ARa=c=>{var d;const e={jNbTIg:!this.fd,gtA7Dw:this.fd};return m6("div",{ref:null===(d=this.Go)||void 0===d?void 0:d.Yf,className:R5("xhBZaw",e,c.className),children:[void 0,this.D5a()]})}}};V5=s6([Mc],V5);
var W5=class a extends o6{static j(b){P(b,{fd:$5,Go:$5,koa:$5})}get fd(){return"rtl"===this.props.sheet.direction}get Go(){var b;const c=null===(b=this.props.xv)||void 0===b?void 0:b.get();if(null!=c&&0!==c.length)return new __c.JE(c)}get koa(){var b,c,d;return null===(c=(d=this.props).jXa)||void 0===c?void 0:null===(b=c.call(d))||void 0===b?void 0:b.get()}render(){return P5(__c.sv,{po:"light",light:"light",Oq:"light",dark:"light",children:this.m6a})}constructor(...b){super(...b);a.j(this);this.onMouseMove=
q6(c=>{const {onMouseMove:d,sheet:e,scale:f=1}=this.props;null===d||void 0===d?void 0:d(c,e,"row",f)});this.onMouseLeave=q6(c=>{var d,e;null===(d=(e=this.props).onMouseLeave)||void 0===d?void 0:d.call(e,c)});this.L5a=()=>{const {sheet:c,bIa:d,EAa:e,Ym:f,scale:g=1}=this.props;let h=-1;return P5("div",{style:void 0,className:R5("_93roJg",{jNbTIg:!this.fd,gtA7Dw:this.fd},{Tn3nUw:void 0}),onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,children:c.rows.map(k=>{h++;return P5(TDb,{na:k,label:`${h+
1}`,Lna:d,Er:e,Ym:f,scale:g},k.id)})})};this.m6a=c=>{var d;const e={jNbTIg:!this.fd,gtA7Dw:this.fd};return m6("div",{ref:null===(d=this.Go)||void 0===d?void 0:d.Yf,className:R5("An9VeA",e,c.className),children:[void 0,this.L5a()]})}}};W5=s6([Mc],W5);
var SDb=T5(a=>{const {label:b,col:c,Lna:d,Er:e,Ym:f,scale:g=1}=a;a=f(g);const h=w6(()=>d(c)),k=w6(()=>e(c));return P5("div",{className:R5("_83Rssw","d2uLIA",{YbLr8g:h,sTqdww:k}),style:{width:c.width*g,height:a},children:P5($Cb,{label:b,width:c.width,height:f(1),scale:g,highlight:h,selected:k})})}),TDb=T5(a=>{const {label:b,na:c,Lna:d,Er:e,Ym:f,scale:g=1}=a;a=f(g);const h=w6(()=>d(c)),k=w6(()=>e(c));return P5("div",{className:R5("_83Rssw","JhBzyw",{YbLr8g:h,sTqdww:k}),style:{width:a,height:c.height*
g},children:P5($Cb,{label:b,width:f(1),height:c.height,scale:g,highlight:h,selected:k})})});var UDb='<svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><circle stroke="currentColor" cx="6" cy="6" r="5.5"/></svg>';var VDb='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle stroke="currentColor" cx="12" cy="12" r="9.25" stroke-width="1.5"/></svg>';var aDb=__c.AT({Al:UDb,medium:VDb});var X5=class a extends o6{static j(b){P(b,{hd:$5.struct})}constructor(...b){super(...b);a.j(this)}render(){return P5(this.props.Cq,{sheet:this.props.element.config,xv:this.props.xv,yy:this.props.yy,Cy:this.props.Cy,scaleFactor:this.props.scaleFactor,hd:this.hd,Yj:this.props.Yj,dH:void 0})}get hd(){const b=this.props.Pd,c=this.props.element.altText;return c?c.Rd&&!b?{"aria-hidden":!0}:{"aria-label":c.text}:{}}};X5=s6([Mc],X5);var WDb=class{constructor(){this.z8=new WeakMap;this.DXa=a=>this.z8.get(a);this.HHa=(a,b)=>{this.z8.set(a,b)};this.kRa=(a,b)=>{const c=this.z8.get(a);c&&c.Gb===b.Gb&&c.Wb===b.Wb&&c.Hg===b.Hg&&this.z8.delete(a)}}};var YDb=T5(a=>{const b=a.Gb,c=a.item,d=a.Hg,e=a.Wb,f=a.Vd,g=a.col,h=a.na,k=a.content,l=a.Oi;a=a.Kt;__c.v("text3"===k.type);__c.dF(a,__c.mq.ya(k.value),(p,q)=>__c.mq.domain.Mb(p,q));[a]=JDb(()=>new XDb(c,e,$5(()=>b.zoom)));const m=S5(()=>new __c.uYa(d,c),[d,c]),n=S5(()=>{var p=new __c.vYa(m,g,h);return new __c.wYa(p,k.value)},[m,g,h,k.value]);return P5(f,{Gb:b,kg:n,text:k.value,Wb:a,Ff:"wrap"===l?"pre-wrap":"nowrap"})}),XDb=class extends __c.fT{static j(a){P(a,{width:r6.ref,CZ:$5})}get DA(){return this.y8.DA}get CZ(){const a=
(this.sia.width-this.y8.width)/2;return{left:-a,right:this.y8.width+a}}constructor(a,b,c){super();XDb.j(this);this.sheet=a;this.y8=b;this.zoom=c;this.width=0;this.marginWidth=void 0;this.sia=new __c.Uy(this.sheet,this.y8,{zoom:this.zoom.get()})}};var x6=parseInt("4px",10)||4,ZDb=T5(({sheet:a,scaleFactor:b,range:c,gt:d,ht:e})=>{if(null!=c&&(d||e)){var f;b=null!==(f=null===b||void 0===b?void 0:b.get())&&void 0!==f?f:1;if(d&&e)return d=a.ua(c.vd)+c.vd.height,a=a.qa(c.ed)+c.ed.width,P5("div",{style:{top:d*b,width:a*b,height:x6*b},className:R5("aX8dhQ","VGcLng")});if(d)return c=a.qa(c.ed)+c.ed.width,P5("div",{style:{left:c*b,width:x6*b,height:a.height*b},className:R5("aX8dhQ","gl1RPg")});if(e)return c=a.ua(c.vd)+c.vd.height,P5("div",{style:{top:c*
b,width:a.width*b,height:x6*b},className:R5("aX8dhQ","VGcLng")})}});var y6=({sheet:a,range:b,scaleFactor:c,children:d})=>{const e=O5();gDb({sheet:a,scaleFactor:c,range:b,Gd:e,Wza:e});return P5("div",{ref:e,className:R5("nstn2A","rtl"===a.direction?"NgnL2Q":"f8jAGQ"),children:d})},$Db=({sheet:a,range:b,scaleFactor:c,children:d})=>{const e=O5(),f=O5();gDb({sheet:a,scaleFactor:c,range:b,Gd:e,Wza:f});a="rtl"===a.direction?"NgnL2Q":"f8jAGQ";return P5("div",{ref:e,className:R5("nstn2A",a,"_9sodyg"),children:P5("div",{ref:f,className:R5("nstn2A",a),children:d})})};var iDb=T5(({sheet:a,children:b,$F:c})=>{const d=U5(f=>{c.wna(a,f)},[c,a]),e=U5(f=>{null!=f?c.bG.set(a,f):c.bG.delete(a)},[c,a]);return P5(__c.scb,{direction:"rtl"===a.config.direction?"rtl":"ltr",onScroll:d,Zt:e,children:b})}),hDb=class{wna(a,b){this.onScroll&&this.onScroll(a);this.KX.set(a,b)}constructor(a){this.onScroll=a;this.bG=new WeakMap;this.KX=r6.map(new Map,{deep:!1});this.scrollTo=q6((b,c)=>{b=this.bG.get(b);null===b||void 0===b?void 0:b.scrollTo({left:Math.floor(c)})})}};var Z5=class a extends o6{static j(b){P(b,{hd:$5.struct})}render(){const b=this.props.item;return P5("div",{ref:this.props.measureRef,className:"E8r86A",style:{width:Math.min(this.props.Wb.width,b.F)},children:P5(this.props.bH,{sheet:b,children:P5("div",{ref:this.props.ZYa,className:"cXTiJA",style:{width:b.F,height:b.N},children:P5(this.props.Cq,{sheet:b.config,xv:this.props.xv,scaleFactor:this.props.scaleFactor,yy:this.props.yy,Cy:this.props.Cy,hd:this.hd,Yj:this.Yj,dH:this.dH})})})})}get hd(){const b=
this.props.Pd,c=this.props.item.altText;return c?c.Rd&&!b?{"aria-hidden":!0}:{"aria-label":c.text}:{}}constructor(...b){super(...b);a.j(this);this.scaleFactor=$5(()=>1);this.Yj=T5(c=>P5("div",{className:"wKvivQ",children:P5(YDb,{...this.props,...c,Vd:this.props.Vd})}));this.dH=({sheet:c,range:d,gt:e,ht:f})=>P5(y6,{sheet:c,range:d,scaleFactor:this.scaleFactor,children:P5(ZDb,{sheet:c,scaleFactor:this.scaleFactor,range:d,gt:e,ht:f})})}};Z5=s6([Mc],Z5);var aEb=T5(({page:a,range:b,Vqa:c})=>{if(null!=c){var d=mDb(a.sheet,b);return P5("div",{className:"Gi9pfA",children:a.elements.map((e,f)=>null==d?P5(c,{element:e},f):__c.ls(__c.ns(e)).Po(d)&&P5(c,{element:e},f))})}});var bEb=new __c.QU,z6=a=>QDb*a,A6=()=>!1,nDb=T5(({page:a,xv:b,yy:c,Cy:d,z3:e,scaleFactor:f,viewport:g,w7a:h,Cq:k,Yj:l,lfb:m,Vqa:n,ncb:p,mcb:q})=>{var r="rtl"===a.sheet.direction,t;const u=null!==(t=null===f||void 0===f?void 0:f.get())&&void 0!==t?t:1;t=S5(()=>T5(({sheet:w,range:x,gt:y,ht:z})=>m6(l6,{children:[P5(y6,{sheet:a.sheet,range:x,scaleFactor:f,children:P5(ZDb,{sheet:w,scaleFactor:f,range:x,gt:y,ht:z})}),m6($Db,{sheet:a.sheet,range:x,scaleFactor:f,children:[m&&P5(m,{}),n&&P5(aEb,{page:a,Vqa:n,
range:x}),q&&P5(q,{})]}),p&&x&&P5(y6,{sheet:a.sheet,range:x,scaleFactor:f,children:P5(p,{range:x})})]})),[n,m,q,p,a,f]);b=P5(k,{sheet:a.sheet,xv:b,yy:c,Cy:d,z3:e,scaleFactor:f,viewport:g,Yj:l,dH:t});r=m6("div",{className:"OsKKIQ",children:[P5("div",{className:"VDFv_A",children:b}),P5("div",{className:"_688KWg",children:P5(bDb,{fd:r,highlight:!1,Ym:z6,scale:u})}),P5("div",{className:"m0cT1w",children:P5(V5,{sheet:a.sheet,scale:u,Ym:z6,iAa:A6,aIa:A6,bC:bEb})}),P5("div",{className:"zm537g",children:P5(W5,
{sheet:a.sheet,scale:u,Ym:z6,EAa:A6,bIa:A6,bC:bEb})})]});return h?r:b});var GDb=class{constructor(a){this.aY=a;this.ZQa=__c.nV;this.yga=u6((b,c,d,e)=>{const f=[];e=this.qXa(b,c,d,e);c=(l,m)=>(l=__c.sj(b.cells,m,l))&&__c.Vta(l);for(const {na:l,column:m,textAlign:n,Ida:p}of e){var g=p.width+("center"===n?0:this.ZQa),h=void 0;switch(n){case "start":case "justify":e=b.qa(m);h=e+g;break;case "center":h=b.qa(m)+m.width/2;e=h-g/2;h+=g/2;break;case "end":h=b.qa(m)+m.width;e=h-g;break;default:throw new D(n);}for(g=d.indexOf(m)-1;0<=g;g--){var k=d[g];if(k!==m&&!c(l,k)||!pDb(e,
h,b.qa(k)+k.width))break;f.push({na:l,column:k,edge:"inlineEnd"})}for(g=d.indexOf(m)+1;g<d.length;g++){k=d[g];if(k!==m&&!c(l,k)||!pDb(e,h,b.qa(k)))break;f.push({na:l,column:k,edge:"inlineStart"})}}return f},{equals:__c.Sh(qDb)});this.qXa=u6((b,c,d,e)=>{const f=[];for(const m of d)for(const n of c){var g,h,k,l=b.layout.cells.get(n,m);if(!l||!l.ref.content.ref&&!l.ref.Ga.ref||l.span.Yb!==l.span.vd||l.span.Vb!==l.span.ed)continue;const {Oi:p,textAlign:q}=mg(__c.Wg,b.layout.attrs.get(Xg({Oi:void 0,textAlign:void 0}),
n,m)||{}),r=this.aY.Ay(b,n,m);d=__c.oI(q,null===(h=l.ref)||void 0===h?void 0:null===(g=h.content.ref)||void 0===g?void 0:g.type,null===(k=l.ref.Ga.ref)||void 0===k?void 0:k.type,r?()=>r.rI.type:void 0);l=e(n,m);"overflow"===p&&l&&d&&f.push({na:n,column:m,textAlign:d,Ida:l})}return f},{equals:__c.Sh(rDb)})}};var c6=(a,b)=>`${a.id}:${b.id}`,a6=(a,b)=>`${a.column.id}-${a.boundary}:${b.na.id}-${b.boundary}`,dEb=class{constructor(){this.RHa=cEb;this.zXa=v6(a=>{const b=new Map;let c=0;a.layout.rows.forEach(d=>{const e=c,f=e+d.height;b.set(d,{start:e,end:f});c=f});return b});this.$Wa=v6(a=>{const b=new Map;var c="rtl"===a.direction;const d=c?-1:1;let e=0;c&&(c=a.layout.cols.last(),e=null!=c?a.qa(c)+c.width:0);a.layout.cols.forEach(f=>{const g=e,h=g+f.width*d;b.set(f,{start:g,end:h});e=h});return b})}},eEb=
class{constructor(){this.$5a=u6((a,b,c,d)=>{const e=a.layout.cells.get(c,b);var f,g,h=g6(null!==(f=null===e||void 0===e?void 0:e.span.Vb)&&void 0!==f?f:b,null!==(g=null===e||void 0===e?void 0:e.span.ed)&&void 0!==g?g:b,a.layout.cols),k,l;f=g6(null!==(k=null===e||void 0===e?void 0:e.span.Yb)&&void 0!==k?k:c,null!==(l=null===e||void 0===e?void 0:e.span.vd)&&void 0!==l?l:c,a.layout.rows);var m=e?c===e.span.Yb:!0;const n=e?c===e.span.vd:!0,p=e?b===e.span.Vb:!0;g=e?b===e.span.ed:!0;if(p||g||m||n){k={};
var q=a.layout.rows.kc(c),r=a.layout.rows.next(c),t=a.layout.cols.kc(b);l=a.layout.cols.next(b);d=d&&this.ERa(d());if(m){m=zDb(a,b,c,d);const la=b&&q&&a.layout.cells.get(q,b);q=b&&q&&ADb(a,b,q,d);var u,w;const ha=g6(null!==(u=null===la||void 0===la?void 0:la.span.Vb)&&void 0!==u?u:b,null!==(w=null===la||void 0===la?void 0:la.span.ed)&&void 0!==w?w:b,a.layout.cols);var x,y;u=a.layout.cols.dg(null!==(x=null===e||void 0===e?void 0:e.span.Vb)&&void 0!==x?x:b,null!==(y=null===la||void 0===la?void 0:la.span.Vb)&&
void 0!==y?y:b);k.ua=b6(m,q,h,ha,u)}if(n){x=ADb(a,b,c,d);y=b&&r&&a.layout.cells.get(r,b);u=b&&r&&zDb(a,b,r,d);var z,B;w=g6(null!==(z=null===y||void 0===y?void 0:y.span.Vb)&&void 0!==z?z:b,null!==(B=null===y||void 0===y?void 0:y.span.ed)&&void 0!==B?B:b,a.layout.cols);var E,G;z=a.layout.cols.dg(null!==(E=null===e||void 0===e?void 0:e.span.Vb)&&void 0!==E?E:b,null!==(G=null===y||void 0===y?void 0:y.span.Vb)&&void 0!==G?G:b);k.Ca=b6(x,u,h,w,z)}if(p){h=BDb(a,b,c,d);E=t&&c&&a.layout.cells.get(c,t);G=t&&
c&&CDb(a,t,c,d);var H,K;z=g6(null!==(H=null===E||void 0===E?void 0:E.span.Yb)&&void 0!==H?H:c,null!==(K=null===E||void 0===E?void 0:E.span.vd)&&void 0!==K?K:c,a.layout.rows);var J,L;H=a.layout.rows.dg(null!==(J=null===e||void 0===e?void 0:e.span.Yb)&&void 0!==J?J:c,null!==(L=null===E||void 0===E?void 0:E.span.Yb)&&void 0!==L?L:c);k.qa=b6(h,G,f,z,H)}if(g){b=CDb(a,b,c,d);J=l&&c&&a.layout.cells.get(c,l);L=l&&c&&BDb(a,l,c,d);var R,T;H=g6(null!==(R=null===J||void 0===J?void 0:J.span.Yb)&&void 0!==R?R:
c,null!==(T=null===J||void 0===J?void 0:J.span.vd)&&void 0!==T?T:c,a.layout.rows);var W,Y;a=a.layout.rows.dg(null!==(W=null===e||void 0===e?void 0:e.span.Yb)&&void 0!==W?W:c,null!==(Y=null===J||void 0===J?void 0:J.span.Yb)&&void 0!==Y?Y:c);k.Ha=b6(b,L,f,H,a)}return k}},{equals:DDb});this.nSa=(a,b,c)=>{const d=new Map;a.forEach(({qa:e,ua:f,Ha:g,Ca:h},k)=>{e&&d.set(e.color,(d.get(e.color)||0)+1);f&&d.set(f.color,(d.get(f.color)||0)+1);g&&c&&k.includes(c.id)&&d.set(g.color,(d.get(g.color)||0)+1);h&&
b&&k.includes(b.id)&&d.set(h.color,(d.get(h.color)||0)+1)});return d};this.ERa=a=>{const b=new Map;for(const {column:c,na:d,edge:e}of a){switch(e){case "blockStart":a={ua:!0};break;case "blockEnd":a={Ca:!0};break;case "inlineStart":a={qa:!0};break;case "inlineEnd":a={Ha:!0};break;default:throw new D(e);}const f=`${c.id}:${d.id}`;b.set(f,{...b.get(f),...a})}return b}}},cEb=new eEb,xDb=new dEb;var B6=class a extends o6{static j(b){P(b,{Una:$5({equals:__c.Sh()}),Vna:$5({equals:__c.Sh()})})}componentDidMount(){const b=C(this.ref.current);xc(this,Y5(()=>{var c=this.props.scaleFactor;const d=this.props.sheet;var e;c=null!==(e=null===c||void 0===c?void 0:c.get())&&void 0!==e?e:1;e=d.height;b.style.width=`${d.width*c}px`;b.style.height=`${e*c}px`}))}get Una(){const b=this.props.sheet;return[...this.props.t$a].sort((c,d)=>b.layout.cols.dg(c,d))}get Vna(){const b=this.props.sheet;return[...this.props.jx].sort((c,
d)=>b.layout.rows.dg(c,d))}render(){var b=this.props.sheet;const c=yDb(b,this.Vna,this.Una,this.yga),d=b.width,e=b.height;b="rtl"===b.direction;return P5("svg",{ref:this.ref,role:"presentation",className:R5("c6a1eQ",{H_CtIQ:!b,_8_56PQ:b}),viewBox:`0 0 ${d} ${e}`,strokeLinecap:"butt",strokeLinejoin:"miter",children:c.map(({lines:f,color:g,weight:h,Ri:k,Si:l})=>P5("path",{stroke:g,strokeDasharray:k,strokeDashoffset:l,strokeWidth:h,d:f.map(({p1:m,p2:n})=>`M ${m.x} ${m.y} L ${n.x} ${n.y}`).join(" ")},
`${g}-${h}-${k}-${l}`))})}constructor(...b){super(...b);a.j(this);this.ref=IDb();this.yga=()=>this.props.Oha.yga(this.props.sheet,this.Vna,this.Una,this.props.uU)}};B6=s6([Mc],B6);var D6=class a extends o6{static j(b){P(b,{K2:$5,JKa:$5})}render(){var b;const c=this.props.IWa;return m6("div",{ref:this.VHa,className:R5("ZTz_iA","ltr"===this.props.sheet.direction?"TA4X7w":"WvuqMw"),children:[(null===c||void 0===c?void 0:c.kQa)&&P5(C6,{...this.props,range:c.kQa.range,gt:!0,ht:!0,className:"_0C8M3w",M0:this.K2}),(null===c||void 0===c?void 0:c.h$a)&&P5(C6,{...this.props,range:c.h$a.range,gt:!1,ht:!0,className:"_7n44yg",M0:this.K2}),(null===c||void 0===c?void 0:c.mYa)&&P5(C6,{...this.props,
range:c.mYa.range,gt:!0,ht:!1,className:"fF5r6w",M0:this.K2}),P5(C6,{...this.props,range:null===c||void 0===c?void 0:null===(b=c.F9a)||void 0===b?void 0:b.range,gt:!1,ht:!1,className:"llILYw",M0:this.JKa})]})}componentDidMount(){const b=Y5(()=>{var c=this.props,d=c.scaleFactor;c=c.sheet;const e=this.VHa.current;e&&(d=d?d.get():1,e.style.width=`${c.width*d}px`,e.style.height=`${c.height*d}px`)});xc(this,[b])}get K2(){return{type:"excluded"}}get JKa(){return{type:"hidden",vM:this.IQa}}constructor(...b){super(...b);
a.j(this);this.VHa=Et();this.IQa=(c,d)=>{var e;const f=this.props.sheet;var g=this.props.IWa;g=null===g||void 0===g?void 0:null===(e=g.F9a)||void 0===e?void 0:e.range;return null==g?!0:0<=f.cols.dg(c,g.Vb)&&0>=f.cols.dg(c,g.ed)&&0<=f.rows.dg(d,g.Yb)&&0>=f.rows.dg(d,g.vd)}}};D6=s6([Mc],D6);
var C6=class a extends o6{static j(b){P(b,{THa:$5})}get THa(){const b=this.props.viewport,c=this.props.gt,d=this.props.ht;return null==b||!c&&!d?b:$5(()=>{const e=__c.vs(b.get());return __c.ns({top:d?0:e.top,left:c?0:e.left,width:e.width,height:e.height})})}render(){const b=this.props.sheet,c=this.props.range,d=this.props.M0,e=this.props.dH,f=this.props.gt,g=this.props.ht;return m6("div",{ref:this.lla,className:R5("i0YQww",this.props.className),children:[P5("div",{ref:this.GEa,className:"vUKoKg",
children:P5("div",{ref:this.HEa,children:P5(E6,{...this.props,viewport:this.THa,bounds:"hidden"===(null===d||void 0===d?void 0:d.type)?void 0:c,vM:"hidden"===(null===d||void 0===d?void 0:d.type)?d.vM:void 0})})}),e&&P5(e,{sheet:b,range:c,gt:f,ht:g})]})}componentDidMount(){const b=Y5(()=>{var h=this.props,k=h.scaleFactor,l=h.sheet;const m=h.range;var n=this.lla.current;const p=this.GEa.current;h=this.HEa.current;k=k?k.get():1;const q=m?l.qa(m.ed)+m.ed.width-l.qa(m.Vb):l.width,r=m?l.ua(m.vd)+m.vd.height-
l.ua(m.Yb):l.height;n&&(n.style.width=`${q*k}px`,n.style.height=`${r*k}px`);p&&(p.style.width=`${q*k}px`,p.style.height=`${r*k}px`);n="rtl"===l.direction;n=m?l.qa(m.Vb)*k*(n?1:-1):0;l=m?-l.ua(m.Yb)*k:0;h&&(h.style.transform=`translate(${n}px, ${l}px)`)}),c=this.props.sheet;var d=this.props.z3;const e=this.props.gt,f=this.props.ht,g=null===d||void 0===d?void 0:d(c,e,f);d=Y5(()=>{const h=this.lla.current;if(null!=h){var k=e||f?"sticky":"relative",l=f?"0px":"unset",m=e?"0px":"unset",n=e?"0px":"unset",
p="rtl"===c.direction;if(null==g)h.style.position=k,h.style.top=l,h.style.left=p?"unset":m,h.style.right=p?n:"unset";else{const x=g.get();var q;h.style.position=null!==(q=x.position)&&void 0!==q?q:k;var r;h.style.top=null!==(r=x.top)&&void 0!==r?r:l;var t;h.style.left=p?"unset":null!==(t=x.left)&&void 0!==t?t:m;var u;h.style.right=p?null!==(u=x.right)&&void 0!==u?u:n:"unset";var w;h.style.transform=null!==(w=x.transform)&&void 0!==w?w:"unset"}}});xc(this,[b,d])}constructor(...b){super(...b);a.j(this);
this.lla=Et();this.GEa=Et();this.HEa=Et()}};C6=s6([Mc],C6);
var fEb=class{constructor(){this.QS=new Map;this.L$a=(a,b,c,d)=>{const e=new fEb;for(const [f,g]of this.QS)c.has(g.na)&&e.QS.set(f,g);c=`${b.id}:${a.id}`;d?e.QS.set(c,{width:d.width,height:d.height,na:a,column:b}):e.QS.delete(c);return e};this.uU=(a,b)=>this.QS.get(`${b.id}:${a.id}`)}},E6=class a extends o6{static j(b){P(b,{uL:r6.shallow,Go:$5,bounds:$5,jx:$5({equals:i6.shallow}),Zpa:$5({equals:i6.shallow}),Xsa:q6,C1:q6.bound})}get Go(){var b;const c=null===(b=this.props.xv)||void 0===b?void 0:b.get();
if(null!=c&&0!==c.length)return new __c.JE(c)}render(){var b;return m6("div",{ref:MDb(this.Gd,null===(b=this.Go)||void 0===b?void 0:b.Yf),children:[P5("div",{ref:this.Vta,className:"_5YlOqQ"}),P5("div",{ref:this.dua,className:"_XCmKw"}),this.uL.map(c=>c.C4a),P5(this.uaa,{uU:this.state.uU})]})}componentDidMount(){const b=h6(()=>[this.Zpa,this.jx],([e,f])=>this.Xsa(e,f),{fireImmediately:!0}),c=Y5(()=>{var e=this.props,f=e.scaleFactor;e=e.sheet;const g=this.Gd.current;g&&(f=f?f.get():1,g.style.width=
`${e.width*f}px`,g.style.height=`${e.height*f}px`)}),d=this.uL.map(e=>FDb(e));xc(this,[c,b,...d])}get bounds(){const b=this.props.sheet,c=this.props.bounds;var d,e,f,g;return{Vb:null!==(d=null===c||void 0===c?void 0:c.Vb)&&void 0!==d?d:b.cols.first(),ed:null!==(e=null===c||void 0===c?void 0:c.ed)&&void 0!==e?e:b.cols.last(),Yb:null!==(f=null===c||void 0===c?void 0:c.Yb)&&void 0!==f?f:b.rows.first(),vd:null!==(g=null===c||void 0===c?void 0:c.vd)&&void 0!==g?g:b.rows.last()}}get jx(){const b=this.bounds,
c=this.props.sheet;var d=this.props.viewport;const e=this.props.scaleFactor.get();var f=500*e,g=null===d||void 0===d?void 0:d.get();d=g?g.tl.y-f:b.Yb?c.ua(b.Yb):0;f=g?g.br.y+f:b.vd?c.ua(b.vd)+b.vd.height:0;g=new Map;for(let h=b.Yb;null!=h&&null!=b.vd&&0>=c.rows.dg(h,b.vd);h=c.rows.next(h)){const k=c.ua(h);if(!(k+h.height<d)){if(k>f)break;g.set(h,k*e)}}return g}get Zpa(){const b=this.bounds,c=this.props.sheet;var d=this.props.viewport;const e=this.props.scaleFactor.get();var f=100*e,g=null===d||void 0===
d?void 0:d.get();d=g?g.tl.x-f:b.Vb?c.qa(b.Vb):0;f=g?g.br.x+f:b.ed?c.qa(b.ed)+b.ed.width:0;g=new Map;for(let h=b.Vb;null!=h&&null!=b.ed&&0>=c.cols.dg(h,b.ed);h=c.cols.next(h)){const k=c.qa(h);if(!(k+h.width<d)){if(k>f)break;g.set(h,k*e)}}return g}Xsa(b,c){const d=C(this.Vta.current),e=C(this.dua.current),f=[],g=new Map;for(const h of this.ELa)c.has(h.na)?g.set(h.na,h):f.push(h);for(const [h,k]of c)c=g.get(h)||f.pop(),c||(c=new gEb(this.C1,h),d.appendChild(c.J0),e.appendChild(c.L0),this.ELa.push(c)),
c.update(k,h,b);for(const h of f)h.hide()}C1(b,c){const d=this.props.Qda,e=this.props.sheet,f=this.props.vM;b=new hEb(this.props.XG,this.props.Yj,d(b,c),e,b,c,f,this.sW);xc(this,FDb(b));this.uL.push(b);return b}constructor(b){super(b);a.j(this);this.Gd=Et();this.Vta=Et();this.dua=Et();this.ELa=[];this.uL=[];this.uaa=T5(c=>{const d=[...this.jx.keys()],e=[...this.Zpa.keys()];return P5(this.props.YNa,{jx:d,t$a:e,uU:c.uU})});this.sW=(c,d,e)=>{this.setState(f=>{const g=e();return f.L$a(d,c,this.jx,g)})};
this.state=new fEb}};E6=s6([Mc],E6);
var gEb=class{static j(a){P(a,{update:q6})}update(a,b,c){[this.J0,this.L0].forEach(d=>{d.style.transform=`translateY(${a}px)`;d.classList.add("FPpqvg")});this.na=b;for(const [d]of c)c=this.uL.get(d),c||(c=this.C1(d,b),this.uL.set(d,c),this.J0.appendChild(c.Tca),this.L0.appendChild(c.AM)),c.update(b)}hide(){[this.J0,this.L0].forEach(a=>{a.style.transform="translate(-1000px, -1000px) scale(0)"})}constructor(a,b){gEb.j(this);this.C1=a;this.na=b;this.J0=document.createElement("div");this.L0=document.createElement("div");
this.uL=new Map}},hEb=class{static j(a){P(a,{t1:r6.ref,na:r6.ref,Ba:$5,attrs:$5,qV:$5,renderer:$5,update:q6})}get C4a(){return this.t1}get Ba(){return __c.sj(this.sheet.cells,this.col,this.na)}get attrs(){return this.sheet.layout.attrs.get(Xg({Oi:0,textAlign:0,direction:0}),this.na,this.col)||{}}get qV(){return this.vM?!this.vM(this.col,this.na):!1}get renderer(){const a=this.Ba;if(a&&(a.content||a.Ga))return this.XG({context:{na:this.na,col:this.col,sheet:this.sheet,attrs:this.attrs},Kt:this.sW,
Yj:this.Yj})}update(a){this.na=a;this.CY.na=a}constructor(a,b,c,d,e,f,g,h){hEb.j(this);var k,l,m,n,p,q;this.XG=a;this.CY=c;this.sheet=d;this.col=e;this.vM=g;this.Tca=document.createElement("div");this.AM=document.createElement("div");this.SD=document.createElement("div");this.KA=document.createElement("div");this.dX=document.createElement("div");this.I0a=()=>{if(this.renderer){var r="react"===this.renderer.type?this.dX:this.KA;if(0!==r.childNodes.length&&(r=r.childNodes[0],r instanceof HTMLElement))return{width:r.clientWidth,
height:r.clientHeight}}};this.na=f;this.Tca.className="_2JFriw";this.AM.className="imy9ug";this.SD.className=R5("pDMp7w",{_0yZ6Qg:"text3"!==(null===(l=this.Ba)||void 0===l?void 0:null===(k=l.content)||void 0===k?void 0:k.type),qhF5uA:"text3"!==(null===(n=this.Ba)||void 0===n?void 0:null===(m=n.content)||void 0===m?void 0:m.type)&&"text2"!==(null===(q=this.Ba)||void 0===q?void 0:null===(p=q.content)||void 0===p?void 0:p.type)});this.KA.className="_30B9pw";this.SD.appendChild(this.KA);this.AM.appendChild(this.SD);
this.dX.className="G7zH2w";this.sW=()=>{h(this.col,this.na,this.I0a)};this.Yj=r=>P5(b,{...r,Kt:this.sW})}};var j6=class extends o6{render(){const a=this.props.sheet,b=this.props.xv,c=this.props.z3,d=this.props.XG,e=this.props.hd,f=this.props.Yj,g=this.props.viewport,h=this.props.dH;return P5("div",{className:R5("SNkrHw","ltr"===a.direction?"TA4X7w":"WvuqMw"),...e,children:P5(D6,{XG:d,Yj:f,YNa:this.uaa,Qda:this.Qda,sheet:a,xv:b,z3:c,scaleFactor:this.scaleFactor,viewport:g,dH:h})})}get scaleFactor(){return this.props.scaleFactor?this.props.scaleFactor:$5(()=>1)}constructor(...a){super(...a);this.uaa=T5(b=>
P5(B6,{...b,sheet:this.props.sheet,scaleFactor:this.scaleFactor,Oha:this.props.Oha}));this.Qda=(b,c)=>new __c.bua(this.props.Jw,this.props.sheet,b,c,this.scaleFactor,this.yy,this.Cy);this.yy=(b,c)=>{var d,e;return null===(d=(e=this.props).yy)||void 0===d?void 0:d.call(e,this.props.sheet,b,c)};this.Cy=(b,c)=>{var d,e;return null===(d=(e=this.props).Cy)||void 0===d?void 0:d.call(e,this.props.sheet,b,c)}}};j6=s6([Mc],j6);__c.gua={iZa:function(a){const b=a.Wl,c=a.Nd,d=a.Fc,e=a.um,f=a.aY,g=a.Jw,h=a.VR;YCb({Iw:a.Iw,De:a.De,y8a:a.zK});const k=HDb({XG:h,aY:f,Jw:g});b.Maa=oDb({Cq:k});c.vaa=eDb({Cq:k});({bOa:a}=lDb({Cq:k,Vd:e(),SHa:new WDb}));d.Yn.Laa=a;const {lMa:l,mMa:m,kMa:n}=dDb();return{wra:T5(p=>P5(NDb,{...p,Cq:k,aOa:l,cOa:m,ZNa:n,Yj:ODb}))}}};
}).call(self, self._fe4d99ebe0d2d259646a80d250150d47);}

}])
//# sourceMappingURL=sourcemaps/2f0b239aed8f2645.js.map